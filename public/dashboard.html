<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/dash.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <title>O Rappa | Dashboard</title>
</head>

<body onload="buscarSexo()">
    <main>
        <nav class="main-menu">
            <h1>Fitness App</h1>
            <img class="logo"
                src="https://github.com/ecemgo/mini-samples-great-tricks/assets/13468728/4cfdcb5a-0137-4457-8be1-6e7bd1f29ebb"
                alt="" />
            <ul>
                <li class="nav-item active">
                    <b></b>
                    <b></b>
                    <a href="#">
                        <i class="fa fa-house nav-icon"></i>
                        <span class="nav-text">Home</span>
                    </a>
                </li>

                <li class="nav-item">
                    <b></b>
                    <b></b>
                    <a href="#">
                        <i class="fa fa-user nav-icon"></i>
                        <span class="nav-text">Profile</span>
                    </a>
                </li>

                <li class="nav-item">
                    <b></b>
                    <b></b>
                    <a href="#">
                        <i class="fa fa-calendar-check nav-icon"></i>
                        <span class="nav-text">Schedule</span>
                    </a>
                </li>

                <li class="nav-item">
                    <b></b>
                    <b></b>
                    <a href="#">
                        <i class="fa fa-person-running nav-icon"></i>
                        <span class="nav-text">Activities</span>
                    </a>
                </li>

                <li class="nav-item">
                    <b></b>
                    <b></b>
                    <a href="#">
                        <i class="fa fa-sliders nav-icon"></i>
                        <span class="nav-text">Settings</span>
                    </a>
                </li>
            </ul>
        </nav>

        <section class="content">
            <div class="left-content">
                <div class="left-bottom">
                    <div class="personal-bests">
                        <h1>Personal Bests</h1>
                        <div class="personal-bests-container">
                            <div class="best-item box-one">
                                <p>Longest Distance Cycling: 4 miles</p>
                                <img src="https://github.com/ecemgo/mini-samples-great-tricks/assets/13468728/a3b3cb3a-5127-498b-91cc-a1d39499164a"
                                    alt="" />
                            </div>
                            <div class="best-item box-two">
                                <p>Longest Roller-Skating: 2 hours</p>
                                <img src="https://github.com/ecemgo/mini-samples-great-tricks/assets/13468728/e0ee8ffb-faa8-462a-b44d-0a18c1d9604c"
                                    alt="" />
                            </div>
                            <div class="best-item box-three">
                                <p>Longest Roller-Skating: 2 hours</p>
                                <img src="https://github.com/ecemgo/mini-samples-great-tricks/assets/13468728/e0ee8ffb-faa8-462a-b44d-0a18c1d9604c"
                                    alt="" />
                            </div>
                        </div>
                    </div>
                </div>

                <div class="activities">
                    <h1>Gráficos</h1>
                    <div class="activity-container">
                        <div class="box1">
                            <div class="chart-container">
                                <canvas id="myChart"></canvas>
                            </div>
                        </div>

                        <div class="image-container img-four">
                            <div class="box2">
                                <div class="chart-container2">
                                    <canvas id="myChart2"></canvas>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div class="right-content">
                <div class="user-info">
                    <div class="icon-container">
                        <i class="fa fa-bell nav-icon"></i>
                        <i class="fa fa-message nav-icon"></i>
                    </div>
                    <h4>Ranking</h4>
                    <img src="https://github.com/ecemgo/mini-samples-great-tricks/assets/13468728/40b7cce2-c289-4954-9be0-938479832a9c"
                        alt="user" />
                </div>

                <div class="active-calories">
                    <h1 style="align-self: flex-start">Active Calories</h1>
                    <div class="active-calories-container">
                        <div class="box" style="--i: 85%">
                            <div class="circle">
                                <h2>85<small>%</small></h2>
                            </div>
                        </div>
                        <div class="calories-content">
                            <p><span>Today:</span> 400</p>
                            <p><span>This Week:</span> 3500</p>
                            <p><span>This Month:</span> 14000</p>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </section>
    </main>
</body>


<script>

    function buscarSexo() {
        fetch("/formulario/receberForm", {
            method: "GET",
            headers: {
                "Content-Type": "application/json",
            }
        })
            .then(function (resposta) {
                if (resposta.ok) {
                    resposta.json().then(function (data) {
                        // Extrai as quantidades do objeto de resultados
                        let quantidades = data.map(item => item.quantidade);
                        // Atualiza os dados do gráfico
                        graficoSexo.data.datasets[0].data = quantidades;
                        graficoSexo.update(); // Atualiza o gráfico com os novos dados
                    });
                } else {
                    throw "Houve um erro ao tentar trazer o resultado";
                }
            })
            .catch(function (erro) {
                console.log(`#ERRO: ${erro}`);
            });
    }


    const ctx = document.getElementById('myChart');

    let graficoSexo = new Chart(ctx, {
        type: 'pie',
        data: {
            labels: ['Feminino', 'Masculino'],
            datasets: [{
                label: 'Gênero',
                backgroundColor: ['#a82ba8', '#368a8a'],
                data: [],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });




    // function buscarSexo() {
    //     fetch("/formulario/receberForm", {
    //         method: "GET",
    //         headers: {
    //             "Content-Type": "application/json",
    //         }
    //     })
    //         .then(function (resposta) {
    //             if (resposta.ok) {
    //                 resposta.json().then(function (data) {
    //                     console.log(data)
    //                     graficoSexo.data.datasets[0].data = [data[0]];
    //                     graficoSexo.update(); // Atualiza o gráfico com os novos dados
    //                 })

    //             } else {
    //                 throw "Houve um erro ao tentar trazer o resultado";
    //             }
    //         })
    //         .catch(function (erro) {
    //             console.log(`#ERRO: ${erro}`);
    //         });
    // }


    // function buscarSexo() {
    //     fetch("/formulario/receberForm", {
    //         method: "GET",
    //         headers: {
    //             "Content-Type": "application/json",
    //         }
    //     })
    //         .then(function (resposta) {
    //             if (resposta.ok) {
    //                 return resposta.json();
    //             } else {
    //                 throw new Error("Houve um erro ao tentar trazer o resultado");
    //             }
    //         })
    //         .then(function (data) {
    //             if (data.length === 0) {
    //                 console.warn("Nenhum resultado encontrado");
    //                 return;
    //             }

    //             // Atualizar o gráfico com os dados recebidos
    //             atualizarGraficoSexo(data);
    //         })
    //         .catch(function (erro) {
    //             console.error(`#ERRO: ${erro}`);
    //         });
    // }

    // function atualizarGraficoSexo(dados) {
    //     const ctx = document.getElementById('myChart').getContext('2d');
    // }

    // const navItems = document.querySelectorAll(".nav-item");

    // navItems.forEach((navItem, i) => {
    //     navItem.addEventListener("click", () => {
    //         navItems.forEach((item, j) => {
    //             item.className = "nav-item";
    //         });
    //         navItem.className = "nav-item active";
    //     });
    // });



    // const labels = [
    //     'Masculino',
    //     'Feminino',
    // ];
    const labels2 = [
        'Rappa Mundi',
        'Lado B Lado A',
        'O Silêncio Q Precede o Esporro',
        'Sete Vezes',
        'Nunca Tem FIm',
    ];

    //  aqui muda a cor das letra
    Chart.defaults.color = '#00000';

    // const data = {
    //     labels: labels,
    //     datasets: [{
    //         label: 'Sexo mais presente',
    //         backgroundColor: ["white", "#fffff"],
    //         borderColor: '#000',
    //         textStrokeColor: '#fff',
    //         data: [15, 20],
    //     },
    //     ]
    // };
    const data2 = {
        labels: labels2,
        datasets: [{
            label: 'Rappa Mundi',
            backgroundColor: ["#fffff"],
            borderColor: '#00000',
            data: [6, 5, 7, 1, 8],
        }
        ]
    };

    // const config = {
    //     type: 'pie',
    //     data: data,
    //     options: {}
    // };
    const config2 = {
        type: 'bar',
        data: data2,
        options: {}
    };

    // const myChart = new Chart(
    //     document.getElementById('myChart'),
    //     config
    // );
    const myChart2 = new Chart(
        document.getElementById('myChart2'),
        config2
    );

    function selecionarFilme() {
        fetch("/dash/selecionarFilme", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({

            }),
        })
            .then(function (resposta) {
                console.log("resposta: ", resposta);
                if (resposta.ok) {
                    resposta.json().then(json => {
                        console.log(json)
                        paragrafo.innerHTML = json.filmeVotado
                    });
                } else {
                    throw "Houve um erro ao tentar selecionar o filme mais escolhido!";
                }
            })
            .catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);

            });

        return false;
    }

    function selecionarlado() {
        fetch("/dash/selecionarlado", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({

            }),
        })
            .then(function (resposta) {
                console.log("resposta: ", resposta);
                if (resposta.ok) {
                    resposta.json().then(json => {
                        console.log(json);
                        console.log(JSON.stringify(json));
                        lado.innerHTML = json.ladoVotado
                    });
                } else {
                    throw "Houve um erro ao tentar selecionar o lado mais escolhido!";
                }
            })
            .catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
            });

        return false;
    }
    // selecionarFilme()
    // selecionarlado()

</script>